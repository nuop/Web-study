<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>商品加减与统计结果</title>
		<script>
			window.onload = function(){
				var oUl = document.getElementById('list');
				var oP = document.getElementById('all');
				var aLi = oUl.getElementsByTagName('li');				
				var oS = oP.getElementsByTagName('span');
				var sum = 0;
				var money = 0;
				var price = 0;
				
 				for(i=0;i<aLi.length;i++){
 					change(aLi[i]);
 				}
 				
				function change(oLi){
					var oBtn = oLi.getElementsByTagName('input');
					var oStrong = oLi.getElementsByTagName('strong')[0];
					var oEm = oLi.getElementsByTagName('em')[0];
					var oSpan = oLi.getElementsByTagName('span')[0];
					var num = Number(oStrong.innerHTML);
					var oneprice = parseFloat(oEm.innerHTML);
					oBtn[1].onclick = function(){
						num++;
						sum ++;
						money += oneprice;
						if(oneprice > price){
							price =oneprice;
						}
						oStrong.innerHTML = num;
						oSpan.innerHTML = num*oneprice;
						oP.innerHTML='商品合计共：'+sum+'件，共花费了：'+money+'元。 其中最贵的商品单价是：'+price+'元';
					}
					oBtn[0].onclick = function(){
						if(num>0){
							num--;
							sum --;
							money -= oneprice;
						}
						if(num == 0){
							price = 0;
						}						
						oStrong.innerHTML = num;
						oSpan.innerHTML = num*oneprice;
						compare();
						oP.innerHTML='商品合计共：'+sum+'件，共花费了：'+money+'元。 其中最贵的商品单价是：'+price+'元';
					}
				}
				function compare(){
					 for (var i=0;i<aLi.length ;i++ ) //点“-”时重新比较最贵单价
                        {
                                if (aLi[i].getElementsByTagName('strong')[0].innerHTML>0)
                                {
                                        if (parseFloat(aLi[i].getElementsByTagName('em')[0].innerHTML)>price)
                                        {
                                                price=parseFloat(aLi[i].getElementsByTagName('em')[0].innerHTML);
                                        }
                                }
                                
                        }
				}
				
			}
		</script>
	</head>
	<body>
		<ul id="list">
			<li>
				<input type="button" value="-" />
				<strong>0</strong>
				<input type="button" value="+" />
				单价：<em>3元</em>
				小计：<span>0元</span>
			</li>
			<li>
				<input type="button" value="-" />
				<strong>0</strong>
				<input type="button" value="+" />
				单价：<em>4元</em>
				小计：<span>0元</span>
			</li>
			<li>
				<input type="button" value="-" />
				<strong>0</strong>
				<input type="button" value="+" />
				单价：<em>5.5元</em>
				小计：<span>0元</span>
			</li>
			<li>
				<input type="button" value="-" />
				<strong>0</strong>
				<input type="button" value="+" />
				单价：<em>6元</em>
				小计：<span>0元</span>
			</li>
			<li>
				<input type="button" value="-" />
				<strong>0</strong>
				<input type="button" value="+" />
				单价：<em>7元</em>
				小计：<span>0元</span>
			</li>
		</ul>
		<p id="all">商品合计共：<span>0</span>件，共花费了：<span>0</span>元</br>
		         其中最贵的商品单价是：<span>2</span>元</p>
	</body>
</html>
